{"ast":null,"code":"var _jsxFileName = \"/mnt/c/Nicholas/Programming/Fullstack/fullstack/Osa8/library-frontend/src/App.js\";\nimport React, { useState, useEffect } from 'react';\nimport Authors from './components/Authors';\nimport Books from './components/Books';\nimport NewBook from './components/NewBook';\nimport LoginForm from './components/LoginForm';\nimport { gql, useQuery, useApolloClient } from '@apollo/client';\nconst ALL_AUTHORS = gql`\n  query {\n    allAuthors {\n      name\n      born\n      bookCount\n    }\n  }\n`;\nconst ALL_BOOKS = gql`\n  query {\n    allBooks { \n      title \n      published\n      author {\n        name\n      }\n    }\n  }\n`;\n\nconst Notify = ({\n  errorMessage\n}) => {\n  if (!errorMessage) {\n    return null;\n  }\n\n  return React.createElement(\"div\", {\n    style: {\n      color: 'red'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 36\n    },\n    __self: this\n  }, errorMessage);\n};\n\nconst App = () => {\n  const [page, setPage] = useState('authors');\n  const allAuthors = useQuery(ALL_AUTHORS);\n  const allBooks = useQuery(ALL_BOOKS);\n  const [authors, setAuthors] = useState([]);\n  const [books, setBooks] = useState([]);\n  const [token, setToken] = useState(null);\n  const [errorMessage, setErrorMessage] = useState(null);\n  const client = useApolloClient();\n  console.log(allBooks.data, 'allBooks.data in App.js');\n  console.log(allAuthors.data, 'allAuthors.data in App.js');\n  useEffect(() => {\n    const token = localStorage.getItem('phonenumbers-user-token');\n\n    if (token) {\n      setToken(token);\n    }\n  }, []);\n  useEffect(() => {\n    if (allAuthors.data) {\n      console.log(allAuthors.data.allAuthors, 'allAuthors.data.allAuthors in App.js');\n      setAuthors(allAuthors.data.allAuthors);\n    }\n  }, [allAuthors]);\n  useEffect(() => {\n    if (allBooks.data) {\n      console.log(allBooks.data.allAuthors, 'allBooks.data.allAuthors in App.js');\n      setBooks(allBooks.data.allBooks);\n    }\n  }, [allBooks]); //if (allAuthors.loading || allBooks.loading)  {\n  //  return <div>loading...</div>\n  //}\n\n  const logout = () => {\n    setToken(null);\n    localStorage.clear();\n    client.resetStore();\n  };\n\n  const notify = message => {\n    setErrorMessage(message);\n    setTimeout(() => {\n      setErrorMessage(null);\n    }, 5000);\n  };\n\n  if (!token) {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 95\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 96\n      },\n      __self: this\n    }, React.createElement(\"button\", {\n      onClick: () => setPage('authors'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }, \"authors\"), React.createElement(\"button\", {\n      onClick: () => setPage('books'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, \"books\"), React.createElement(\"button\", {\n      onClick: () => setPage('login'),\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }, \"login\")), React.createElement(Notify, {\n      errorMessage: errorMessage,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    }), React.createElement(LoginForm, {\n      setToken: setToken,\n      setPage: setPage,\n      setError: notify,\n      show: page === 'login',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }), React.createElement(Authors, {\n      token: token,\n      authors: authors,\n      show: page === 'authors',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 111\n      },\n      __self: this\n    }), React.createElement(Books, {\n      books: books,\n      show: page === 'books',\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 116\n      },\n      __self: this\n    }));\n  }\n\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 125\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 126\n    },\n    __self: this\n  }, React.createElement(\"button\", {\n    onClick: () => setPage('authors'),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127\n    },\n    __self: this\n  }, \"authors\"), React.createElement(\"button\", {\n    onClick: () => setPage('books'),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128\n    },\n    __self: this\n  }, \"books\"), React.createElement(\"button\", {\n    onClick: () => setPage('add'),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129\n    },\n    __self: this\n  }, \"add book\"), React.createElement(\"button\", {\n    onClick: logout,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130\n    },\n    __self: this\n  }, \"logout\")), React.createElement(Notify, {\n    errorMessage: errorMessage,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133\n    },\n    __self: this\n  }), React.createElement(Authors, {\n    token: token,\n    authors: authors,\n    show: page === 'authors',\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135\n    },\n    __self: this\n  }), React.createElement(Books, {\n    books: books,\n    show: page === 'books',\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140\n    },\n    __self: this\n  }), React.createElement(NewBook, {\n    token: token,\n    show: page === 'add',\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144\n    },\n    __self: this\n  }));\n};\n\nexport default App;","map":{"version":3,"sources":["/mnt/c/Nicholas/Programming/Fullstack/fullstack/Osa8/library-frontend/src/App.js"],"names":["React","useState","useEffect","Authors","Books","NewBook","LoginForm","gql","useQuery","useApolloClient","ALL_AUTHORS","ALL_BOOKS","Notify","errorMessage","color","App","page","setPage","allAuthors","allBooks","authors","setAuthors","books","setBooks","token","setToken","setErrorMessage","client","console","log","data","localStorage","getItem","logout","clear","resetStore","notify","message","setTimeout"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react'\nimport Authors from './components/Authors'\nimport Books from './components/Books'\nimport NewBook from './components/NewBook'\nimport LoginForm from './components/LoginForm'\nimport { gql, useQuery, useApolloClient } from '@apollo/client'\n\nconst ALL_AUTHORS = gql`\n  query {\n    allAuthors {\n      name\n      born\n      bookCount\n    }\n  }\n`\n\nconst ALL_BOOKS = gql`\n  query {\n    allBooks { \n      title \n      published\n      author {\n        name\n      }\n    }\n  }\n`\n\nconst Notify = ({ errorMessage }) => {\n  if ( !errorMessage ) {\n    return null\n  }\n\n  return (\n    <div style={{color: 'red'}}>\n      {errorMessage}\n    </div>\n  )\n}\n\nconst App = () => {\n  const [page, setPage] = useState('authors')\n  const allAuthors = useQuery(ALL_AUTHORS)\n  const allBooks = useQuery(ALL_BOOKS)\n  const [authors, setAuthors] = useState([])\n  const [books, setBooks] = useState([])\n  const [token, setToken] = useState(null)\n  const [errorMessage, setErrorMessage] = useState(null)\n  const client = useApolloClient()\n\n  console.log(allBooks.data, 'allBooks.data in App.js')\n  console.log(allAuthors.data, 'allAuthors.data in App.js')\n\n  useEffect(() => {\n    const token = localStorage.getItem('phonenumbers-user-token')\n    if ( token ) {\n      setToken(token)\n    }\n  }, [])\n\n  useEffect(() => {\n    if (allAuthors.data) {\n      console.log(allAuthors.data.allAuthors, 'allAuthors.data.allAuthors in App.js')\n      setAuthors(allAuthors.data.allAuthors)\n    }\n  }, [allAuthors])\n\n  useEffect(() => {\n    if (allBooks.data) {\n      console.log(allBooks.data.allAuthors, 'allBooks.data.allAuthors in App.js')\n      setBooks(allBooks.data.allBooks)\n    }\n  }, [allBooks])\n\n  //if (allAuthors.loading || allBooks.loading)  {\n  //  return <div>loading...</div>\n  //}\n\n  const logout = () => {\n    setToken(null)\n    localStorage.clear()\n    client.resetStore()\n  }\n\n  const notify = (message) => {\n    setErrorMessage(message)\n    setTimeout(() => {\n      setErrorMessage(null)\n    }, 5000)\n  }\n\n  if (!token) {\n    return (\n      <div>\n        <div>\n        <button onClick={() => setPage('authors')}>authors</button>\n        <button onClick={() => setPage('books')}>books</button>\n        <button onClick={() => setPage('login')}>login</button>\n        </div>\n\n        <Notify errorMessage={errorMessage} />\n\n        <LoginForm\n          setToken={setToken}\n          setPage={setPage}\n          setError={notify}\n          show={page === 'login'}\n        />\n\n        <Authors token={token} \n          authors={authors}\n          show={page === 'authors'}\n        />\n\n        <Books books={books} \n          show={page === 'books'}\n        />\n        \n      </div>\n    )\n  }\n\n  return (\n    <div>\n      <div>\n        <button onClick={() => setPage('authors')}>authors</button>\n        <button onClick={() => setPage('books')}>books</button>\n        <button onClick={() => setPage('add')}>add book</button>\n        <button onClick={logout} >logout</button>\n      </div>\n\n      <Notify errorMessage={errorMessage} />\n\n      <Authors token={token} \n        authors={authors}\n        show={page === 'authors'}\n      />\n\n      <Books books={books}\n        show={page === 'books'}\n      />\n\n      <NewBook\n        token={token}\n        show={page === 'add'}\n      />\n\n    </div>\n  )\n}\n\nexport default App"]},"metadata":{},"sourceType":"module"}